%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{scdc}
\date{Dec 21, 2020}
\release{0.0}
\author{Yonit Hochberg, Eric David Kramer, Noah Kurinsky, and Benjamin V.\@{} Lehmann}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxtitleref{scdc} stands for \sphinxtitleref{quasiparticle Monte Carlo}. This code simulates the relaxation of quasiparticle excitations produced by an energy deposit in a superconductor, with particular attention to energy deposits from dark matter scattering. The code was developed to study directional correlations between the initial and final states, and is bundled with some simple tools to quantify that relationship.

The basic structure of the calculation is as follows: an energy deposit produces initial quasiparticles and/or phonons. The quasiparticles can relax by emitting phonons, and sufficiently energetic phonons can decay to quasiparticle pairs. This process continues until all quasiparticles are too low\sphinxhyphen{}energy to emit a phonon, and all phonons are too low\sphinxhyphen{}energy to produce a quasiparticle pair. These excitations constitute the final state, and we say that they are \sphinxtitleref{ballistic}. The full set of excitations connecting initial to final states is generated as a tree of python objects, so every step of the shower can be inspected directly.

The main non\sphinxhyphen{}triviality is that the kinematical equations governing phonons and quasiparticles cannot be solved analytically, so the code solves them numerically.


\chapter{Contents}
\label{\detokenize{index:contents}}

\section{Kinematics}
\label{\detokenize{kinematics:kinematics}}\label{\detokenize{kinematics::doc}}
We now review the kinematics of phonons and quasiparticles as treated by the code. Note that we work in the “clean” limit, where crystal momentum is conserved.


\subsection{Units}
\label{\detokenize{kinematics:units}}
In the code, we work in “material” units, setting \(v_\ell = k_F = \Delta = 1\). This implies that \(\hbar = 2\gamma\sqrt z\), where \(z\equiv E_F/\Delta\).


\subsection{Dispersion relations}
\label{\detokenize{kinematics:dispersion-relations}}
The phonon dispersion relation is \(E=\hbar q\). This is invertible: a phonon’s energy uniquely determines its momentum. The same is not true for a quasiparticle, which has dispersion relation
\begin{equation*}
\begin{split}E = \left[1 + \left(\frac{\hbar^2 k^2}{2m_e} - z\right)^2\right]^{1/2}.\end{split}
\end{equation*}
The inverse is requires a choice of sign:
\begin{equation*}
\begin{split}k = \frac{1}{\hbar}\left[
        2m_e\left(
            z \pm\sqrt{E^2 - 1}
        \right)
    \right]^{1/2}.\end{split}
\end{equation*}
This corresponds to the fact that the energy is minimized (\(E=\Delta\)) at the Fermi surface, \(k=k_F\), and increases in either direction. In the code, \sphinxstyleemphasis{if a quasiparticle is instantiated with only energy specified, we choose this sign randomly.}


\subsection{Phonon decay to quasiparticles}
\label{\detokenize{kinematics:phonon-decay-to-quasiparticles}}
A phonon can decay to quasiparticles if it has enough energy to produce a quasiparticle pair, i.e., \(E>2\Delta\). Such a decay is characterized by the energy \(\omega\) of one of the two quasiparticles (and the azimuthal angle, which is always uniform\sphinxhyphen{}random). We take the differential rate in this variable from eq. (27) of Kaplan et al. (1976):
\begin{equation*}
\begin{split}\frac{\mathrm d\Gamma}{\mathrm d\omega} =
    \frac{1}{\sqrt{\omega^2 - \Delta^2}}
    \frac{\omega\left(E-\omega\right) + \Delta^2}
         {\sqrt{(E-\omega)^2 - \Delta^2}}
.\end{split}
\end{equation*}
There is a complication here, however, because this gives the differential rate as a function of quasiparticle \sphinxstyleemphasis{energy.} As we just discussed, the energy does not uniquely determine the momentum of a quasiparticle, which is essential to ensure that we satisfy conservation of momentum. Since the decay rate into each allowed final\sphinxhyphen{}state momentum should be equivalent, we \sphinxstyleemphasis{randomly} select the sign in the inverse dispersion relation for each quasiparticle.

But this introduces yet another complication: it is possible that one or more of these sign combinations is not kinematically allowed, in that they can produce decays with \(|\cos\theta|>1\). Thus, we first select \(\omega\) according to the above distribution, and then check whether each sign combination is kinematically allowed. We randomly select from the allowed combinations. These are called \sphinxstyleemphasis{candidate} final states.


\subsection{Phonon emission by quasiparticles}
\label{\detokenize{kinematics:phonon-emission-by-quasiparticles}}

\section{Structure of the code}
\label{\detokenize{code_structure:structure-of-the-code}}\label{\detokenize{code_structure::doc}}

\subsection{Events and overall structure of the calculation}
\label{\detokenize{code_structure:module-scdc.event}}\label{\detokenize{code_structure:events-and-overall-structure-of-the-calculation}}\index{module@\spxentry{module}!scdc.event@\spxentry{scdc.event}}\index{scdc.event@\spxentry{scdc.event}!module@\spxentry{module}}
The structure of the calculation is as follows.

A scattering event produces two quasiparticles. Each of those quasiparticles
can subsequently relax by emitting phonons. If sufficiently energetic, those
phonons can themselves decay to quasiparticle pairs. The process continues
until none of the products have enough energy to undergo another scatter or
decay.

This picture describes a tree of particles with interactions as the nodes of
the tree, and we use a very similar structure to implement the calculation
programmatically. Our tree consists of three types of object:
\begin{itemize}
\item {} 
Event

\item {} 
Interaction

\item {} 
Particle

\end{itemize}

In tree language, \sphinxtitleref{Event} objects are nodes and \sphinxtitleref{Particle} objects are edges.
\sphinxtitleref{Interaction} objects couple a single \sphinxtitleref{Event} object to a collection of
\sphinxtitleref{Particle} objects.

Why not just have \sphinxtitleref{Interaction} and \sphinxtitleref{Particle} objects? Because a third type
(\sphinxtitleref{Event}) is required to specify the relationship between the two. The
\sphinxtitleref{Interaction} types certainly need to know about \sphinxtitleref{Particle} types in order to
create the final state of each interaction. But then how would a \sphinxtitleref{Particle}
know about the \sphinxtitleref{Interaction} types for which it can be an initial state?
Alternatively, how would each \sphinxtitleref{Interaction} type know about all the others? At
a technical level, this would require a circular import. At a conceptual
level, it indicates a mutual dependency between \sphinxtitleref{Particle} and \sphinxtitleref{Interaction}
types that deserves its own container.

So instead, the structure is as follows. The nodes in the tree are \sphinxtitleref{Event}
objects. \sphinxtitleref{Particle} objects are the edges between \sphinxtitleref{Event} objects. The \sphinxtitleref{Event}
objects “know” what \sphinxtitleref{Interaction} types are possible for a given \sphinxtitleref{Particle},
and they use such an \sphinxtitleref{Interaction} object internally to produce a new final
state. The \sphinxtitleref{Event} can then create new \sphinxtitleref{Event} nodes at which to terminate
each final\sphinxhyphen{}state \sphinxtitleref{Particle}.

Each \sphinxtitleref{Interaction} can also be physically prohibited. When this happens, the
“initial” state of such an \sphinxtitleref{Interaction} is a leaf of the tree.
\index{Event (class in scdc.event)@\spxentry{Event}\spxextra{class in scdc.event}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.event.Event}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.event.}}\sphinxbfcode{\sphinxupquote{Event}}}{\emph{\DUrole{n}{initial\_state}}, \emph{\DUrole{n}{material}}, \emph{\DUrole{o}{*}\DUrole{n}{args}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
Interaction tree node.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{initial\_state}} (\sphinxcode{\sphinxupquote{list}} of \sphinxcode{\sphinxupquote{Particle}}) \textendash{} particles in the
initial state. The initial state is always listlike, even if it
contains only one object.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{(}}\sphinxstyleliteralstrong{\sphinxupquote{obj}} (\sphinxstyleliteralemphasis{\sphinxupquote{material}}) \textendash{} \sphinxtitleref{Material}): the material in which this takes place.

\end{itemize}

\end{description}\end{quote}
\index{initial\_state (scdc.event.Event attribute)@\spxentry{initial\_state}\spxextra{scdc.event.Event attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.event.Event.initial_state}}\pysigline{\sphinxbfcode{\sphinxupquote{initial\_state}}}
particles in the
initial state. The initial state is always a list, even if it
contains only one object.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{list}} of \sphinxcode{\sphinxupquote{Particle}}

\end{description}\end{quote}

\end{fulllineitems}



\begin{fulllineitems}
\pysigline{\sphinxbfcode{\sphinxupquote{material~(obj}}}
\sphinxtitleref{Material}): the material in which this takes place.

\end{fulllineitems}

\index{interaction (scdc.event.Event attribute)@\spxentry{interaction}\spxextra{scdc.event.Event attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.event.Event.interaction}}\pysigline{\sphinxbfcode{\sphinxupquote{interaction}}}
the interaction which can take place
given the supplied initial state.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{Interaction}}

\end{description}\end{quote}

\end{fulllineitems}

\index{out (scdc.event.Event attribute)@\spxentry{out}\spxextra{scdc.event.Event attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.event.Event.out}}\pysigline{\sphinxbfcode{\sphinxupquote{out}}}
particle \sphinxtitleref{Event} objects.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{list}} of \sphinxcode{\sphinxupquote{Particle}}

\end{description}\end{quote}

\end{fulllineitems}

\index{final (scdc.event.Event attribute)@\spxentry{final}\spxextra{scdc.event.Event attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.event.Event.final}}\pysigline{\sphinxbfcode{\sphinxupquote{final}}}
\sphinxtitleref{True} if no further interaction can take place.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{act() (scdc.event.Event method)@\spxentry{act()}\spxextra{scdc.event.Event method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.event.Event.act}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{act}}}{}{}
Run the interaction and generate a final state.

\end{fulllineitems}

\index{chain() (scdc.event.Event method)@\spxentry{chain()}\spxextra{scdc.event.Event method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.event.Event.chain}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{chain}}}{}{}
Run the interaction and run particle interactions recursively.

\end{fulllineitems}

\index{leaf\_events() (scdc.event.Event property)@\spxentry{leaf\_events()}\spxextra{scdc.event.Event property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.event.Event.leaf_events}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{leaf\_events}}}
final events in the detector.

These are the leaves of the event tree, corresponding to the final
states that will be measured.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{list}} of {\hyperref[\detokenize{code_structure:scdc.event.Event}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{Event}}}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{leaf\_particles() (scdc.event.Event property)@\spxentry{leaf\_particles()}\spxextra{scdc.event.Event property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.event.Event.leaf_particles}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{leaf\_particles}}}
final particles after relaxation.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{list}} of \sphinxcode{\sphinxupquote{Particle}}

\end{description}\end{quote}

\end{fulllineitems}

\index{out() (scdc.event.Event property)@\spxentry{out()}\spxextra{scdc.event.Event property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:id0}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{out}}}
List of out.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{list}} of {\hyperref[\detokenize{code_structure:scdc.event.Event}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{Event}}}}}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Particle objects}
\label{\detokenize{code_structure:module-scdc.particle}}\label{\detokenize{code_structure:particle-objects}}\index{module@\spxentry{module}!scdc.particle@\spxentry{scdc.particle}}\index{scdc.particle@\spxentry{scdc.particle}!module@\spxentry{module}}\index{DarkMatter (class in scdc.particle)@\spxentry{DarkMatter}\spxextra{class in scdc.particle}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.DarkMatter}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.particle.}}\sphinxbfcode{\sphinxupquote{DarkMatter}}}{\emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
A dark matter particle.
\index{dispersion() (scdc.particle.DarkMatter method)@\spxentry{dispersion()}\spxextra{scdc.particle.DarkMatter method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.DarkMatter.dispersion}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{dispersion}}}{\emph{\DUrole{n}{p}}}{}
Dispersion relation for dark matter.

Be careful: there is a need for conversion to the material’s own
canonical units. (NOT currently implemented.)
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{p}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} momentum in who\sphinxhyphen{}knows\sphinxhyphen{}what units…to fix.

\item[{Returns}] \leavevmode
dark matter energy in units of Delta.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Particle (class in scdc.particle)@\spxentry{Particle}\spxextra{class in scdc.particle}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.particle.}}\sphinxbfcode{\sphinxupquote{Particle}}}{\emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
Represents a single phonon or quasiparticle with a tree of children.

\sphinxtitleref{momentum} must be specified unless \sphinxtitleref{dispersion\_inverse} is defined, in
which case either \sphinxtitleref{momentum} or \sphinxtitleref{energy} can be specified.

All quantities are specified in canonical units (v\_l=k\_F=Delta=1).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{energy}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} energy in units of Delta.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{momentum}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} momentum in canonical units.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{cos\_theta}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} cosine of angle wrt global z.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{material}} (\sphinxcode{\sphinxupquote{Material}}) \textendash{} material properties.

\end{itemize}

\end{description}\end{quote}
\index{energy (scdc.particle.Particle attribute)@\spxentry{energy}\spxextra{scdc.particle.Particle attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle.energy}}\pysigline{\sphinxbfcode{\sphinxupquote{energy}}}
energy in units of Delta.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{cos\_theta (scdc.particle.Particle attribute)@\spxentry{cos\_theta}\spxextra{scdc.particle.Particle attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle.cos_theta}}\pysigline{\sphinxbfcode{\sphinxupquote{cos\_theta}}}
cosine of angle wrt global z.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{material (scdc.particle.Particle attribute)@\spxentry{material}\spxextra{scdc.particle.Particle attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle.material}}\pysigline{\sphinxbfcode{\sphinxupquote{material}}}
material properties.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{Material}}

\end{description}\end{quote}

\end{fulllineitems}

\index{parent (scdc.particle.Particle attribute)@\spxentry{parent}\spxextra{scdc.particle.Particle attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle.parent}}\pysigline{\sphinxbfcode{\sphinxupquote{parent}}}
parent particle.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
{\hyperref[\detokenize{code_structure:scdc.particle.Particle}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{Particle}}}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{origin (scdc.particle.Particle attribute)@\spxentry{origin}\spxextra{scdc.particle.Particle attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle.origin}}\pysigline{\sphinxbfcode{\sphinxupquote{origin}}}
the originating \sphinxtitleref{Event} for this particle.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{Event}}

\end{description}\end{quote}

\end{fulllineitems}

\index{dest (scdc.particle.Particle attribute)@\spxentry{dest}\spxextra{scdc.particle.Particle attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle.dest}}\pysigline{\sphinxbfcode{\sphinxupquote{dest}}}
the destination \sphinxtitleref{Event} for this particle.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{Event}}

\end{description}\end{quote}

\end{fulllineitems}

\index{shortname (scdc.particle.Particle attribute)@\spxentry{shortname}\spxextra{scdc.particle.Particle attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle.shortname}}\pysigline{\sphinxbfcode{\sphinxupquote{shortname}}}
a short label for this particle type.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
str

\end{description}\end{quote}

\end{fulllineitems}

\index{dispersion() (scdc.particle.Particle method)@\spxentry{dispersion()}\spxextra{scdc.particle.Particle method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle.dispersion}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{dispersion}}}{\emph{\DUrole{n}{k}}}{}
Disperion relation: wavenumber to energy.

\end{fulllineitems}

\index{dispersion\_inverse() (scdc.particle.Particle method)@\spxentry{dispersion\_inverse()}\spxextra{scdc.particle.Particle method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle.dispersion_inverse}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{dispersion\_inverse}}}{\emph{\DUrole{n}{E}}}{}
Inverse dispersion relation: energy to wavenumber.

\end{fulllineitems}

\index{energy() (scdc.particle.Particle property)@\spxentry{energy()}\spxextra{scdc.particle.Particle property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:id1}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{energy}}}
energy in units of Delta.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{momentum() (scdc.particle.Particle property)@\spxentry{momentum()}\spxextra{scdc.particle.Particle property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Particle.momentum}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{momentum}}}
momentum in canonical units (v\_l=k\_F=Delta=1).
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{ParticleCollection (class in scdc.particle)@\spxentry{ParticleCollection}\spxextra{class in scdc.particle}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.particle.}}\sphinxbfcode{\sphinxupquote{ParticleCollection}}}{\emph{\DUrole{o}{*}\DUrole{n}{args}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
Represents a collection of particles.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{particles}} (\sphinxcode{\sphinxupquote{list}} of {\hyperref[\detokenize{code_structure:scdc.particle.Particle}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{Particle}}}}}) \textendash{} particles.

\end{description}\end{quote}
\index{particles (scdc.particle.ParticleCollection attribute)@\spxentry{particles}\spxextra{scdc.particle.ParticleCollection attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.particles}}\pysigline{\sphinxbfcode{\sphinxupquote{particles}}}
particles.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{list}} of {\hyperref[\detokenize{code_structure:scdc.particle.Particle}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{Particle}}}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{energy (scdc.particle.ParticleCollection attribute)@\spxentry{energy}\spxextra{scdc.particle.ParticleCollection attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.energy}}\pysigline{\sphinxbfcode{\sphinxupquote{energy}}}
energy of each particle.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{ndarray}} of float

\end{description}\end{quote}

\end{fulllineitems}

\index{momentum (scdc.particle.ParticleCollection attribute)@\spxentry{momentum}\spxextra{scdc.particle.ParticleCollection attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.momentum}}\pysigline{\sphinxbfcode{\sphinxupquote{momentum}}}
momentum of each particle.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{ndarray}} of float

\end{description}\end{quote}

\end{fulllineitems}

\index{cos\_theta (scdc.particle.ParticleCollection attribute)@\spxentry{cos\_theta}\spxextra{scdc.particle.ParticleCollection attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.cos_theta}}\pysigline{\sphinxbfcode{\sphinxupquote{cos\_theta}}}
cos\_theta of each particle.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{ndarray}} of float

\end{description}\end{quote}

\end{fulllineitems}

\index{cos\_theta() (scdc.particle.ParticleCollection property)@\spxentry{cos\_theta()}\spxextra{scdc.particle.ParticleCollection property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:id2}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{cos\_theta}}}
array of particle \sphinxtitleref{cos\_theta} values.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{ndarray}}

\end{description}\end{quote}

\end{fulllineitems}

\index{dm() (scdc.particle.ParticleCollection property)@\spxentry{dm()}\spxextra{scdc.particle.ParticleCollection property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.dm}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{dm}}}
subcollection of DM particles.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
{\hyperref[\detokenize{code_structure:scdc.particle.ParticleCollection}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{ParticleCollection}}}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{energy() (scdc.particle.ParticleCollection property)@\spxentry{energy()}\spxextra{scdc.particle.ParticleCollection property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:id3}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{energy}}}
array of particle energies.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{ndarray}}

\end{description}\end{quote}

\end{fulllineitems}

\index{from\_npy() (scdc.particle.ParticleCollection class method)@\spxentry{from\_npy()}\spxextra{scdc.particle.ParticleCollection class method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.from_npy}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{classmethod }}\sphinxbfcode{\sphinxupquote{from\_npy}}}{\emph{\DUrole{n}{npy}}, \emph{\DUrole{n}{material}}}{}
Construct a \sphinxtitleref{ParticleCollection} from the numpy representation.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{npy}} (\sphinxcode{\sphinxupquote{ndarray}}) \textendash{} a structured array with columns as specified
in the \sphinxtitleref{to\_npy} method.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{material}} (\sphinxcode{\sphinxupquote{Material}}) \textendash{} the material to associate with these
particles. The material is not stored in the numpy format.

\end{itemize}

\item[{Returns}] \leavevmode
a corresponding \sphinxtitleref{ParticleCollection}.

\item[{Return type}] \leavevmode
{\hyperref[\detokenize{code_structure:scdc.particle.ParticleCollection}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{ParticleCollection}}}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{nondark() (scdc.particle.ParticleCollection property)@\spxentry{nondark()}\spxextra{scdc.particle.ParticleCollection property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.nondark}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{nondark}}}
subcollection of non\sphinxhyphen{}DM particles.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
{\hyperref[\detokenize{code_structure:scdc.particle.ParticleCollection}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{ParticleCollection}}}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{phonons() (scdc.particle.ParticleCollection property)@\spxentry{phonons()}\spxextra{scdc.particle.ParticleCollection property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.phonons}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{phonons}}}
subcollection of phonons.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
{\hyperref[\detokenize{code_structure:scdc.particle.ParticleCollection}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{ParticleCollection}}}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{quasiparticles() (scdc.particle.ParticleCollection property)@\spxentry{quasiparticles()}\spxextra{scdc.particle.ParticleCollection property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.quasiparticles}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{quasiparticles}}}
subcollection of quasiparticles.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
{\hyperref[\detokenize{code_structure:scdc.particle.ParticleCollection}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{ParticleCollection}}}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{select() (scdc.particle.ParticleCollection method)@\spxentry{select()}\spxextra{scdc.particle.ParticleCollection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.select}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{select}}}{\emph{\DUrole{n}{test}}}{}
Select a subset of particles which satisfy a test.

The argument \sphinxtitleref{test} is a function with call signature
\begin{quote}

\sphinxtitleref{test(parent, particle)}
\end{quote}

which returns \sphinxtitleref{True} if the leaf \sphinxtitleref{particle} in the chain arising from
the initial particle \sphinxtitleref{parent} satisifes the test.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{test}} (\sphinxstyleliteralemphasis{\sphinxupquote{function}}) \textendash{} the test function.

\item[{Returns}] \leavevmode
\begin{description}
\item[{collection consisting of particles which}] \leavevmode
satisfy the test.

\end{description}


\item[{Return type}] \leavevmode
{\hyperref[\detokenize{code_structure:scdc.particle.ParticleCollection}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{ParticleCollection}}}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{to\_npy() (scdc.particle.ParticleCollection method)@\spxentry{to\_npy()}\spxextra{scdc.particle.ParticleCollection method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.ParticleCollection.to_npy}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{to\_npy}}}{}{}
Represent this particle collection in numpy format for export.

The numpy format is a structured array with the following columns:
\begin{quote}

shortname    momentum    cos\_theta
\end{quote}

The numpy form REQUIRES momenta for all particles.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
the array form of this collection.

\item[{Return type}] \leavevmode
\sphinxcode{\sphinxupquote{ndarray}}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Phonon (class in scdc.particle)@\spxentry{Phonon}\spxextra{class in scdc.particle}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Phonon}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.particle.}}\sphinxbfcode{\sphinxupquote{Phonon}}}{\emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
A phonon.
\index{dispersion() (scdc.particle.Phonon method)@\spxentry{dispersion()}\spxextra{scdc.particle.Phonon method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Phonon.dispersion}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{dispersion}}}{\emph{\DUrole{n}{k}}}{}
Dispersion relation for phonons.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{k}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} wavenumber in canonical units (v\_l=k\_F=Delta=1).

\item[{Returns}] \leavevmode
phonon energy in units of Delta.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{dispersion\_inverse() (scdc.particle.Phonon method)@\spxentry{dispersion\_inverse()}\spxextra{scdc.particle.Phonon method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Phonon.dispersion_inverse}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{dispersion\_inverse}}}{\emph{\DUrole{n}{E}}}{}
Inverse dispersion relation for phonons.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{E}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} phonon energy in units of Delta.

\item[{Returns}] \leavevmode
phonon wavenumber in canonical units (v\_l=k\_F=Delta=1).

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Quasiparticle (class in scdc.particle)@\spxentry{Quasiparticle}\spxextra{class in scdc.particle}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Quasiparticle}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.particle.}}\sphinxbfcode{\sphinxupquote{Quasiparticle}}}{\emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
A Bogoliubov quasiparticle.
\index{dispersion() (scdc.particle.Quasiparticle method)@\spxentry{dispersion()}\spxextra{scdc.particle.Quasiparticle method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Quasiparticle.dispersion}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{dispersion}}}{\emph{\DUrole{n}{k}}}{}
Dispersion relation for quasiparticles.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{k}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} wavenumber in canonical units (v\_l=k\_F=Delta=1).

\item[{Returns}] \leavevmode
quasiparticle energy in units of Delta.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{dispersion\_inverse() (scdc.particle.Quasiparticle method)@\spxentry{dispersion\_inverse()}\spxextra{scdc.particle.Quasiparticle method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Quasiparticle.dispersion_inverse}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{dispersion\_inverse}}}{\emph{\DUrole{n}{E}}}{}
Inverse dispersion relation for quasiparticles.

Warning: the dispersion relation is not actually invertible. There are
two possible choices of a sign. If the sign \sphinxtitleref{s} is not specified, this
method selects it randomly!
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{E}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} quasiparticle energy.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{s}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} sign in the momentum solution.

\end{itemize}

\item[{Returns}] \leavevmode
quasiparticle wavenumber in units v\_l=k\_F=Delta=1.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{ksign() (scdc.particle.Quasiparticle property)@\spxentry{ksign()}\spxextra{scdc.particle.Quasiparticle property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.particle.Quasiparticle.ksign}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{ksign}}}
the sign as determined from energy and momentum.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Interaction objects}
\label{\detokenize{code_structure:module-scdc.interaction}}\label{\detokenize{code_structure:interaction-objects}}\index{module@\spxentry{module}!scdc.interaction@\spxentry{scdc.interaction}}\index{scdc.interaction@\spxentry{scdc.interaction}!module@\spxentry{module}}\index{DarkMatterScatter (class in scdc.interaction)@\spxentry{DarkMatterScatter}\spxextra{class in scdc.interaction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.DarkMatterScatter}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.interaction.}}\sphinxbfcode{\sphinxupquote{DarkMatterScatter}}}{\emph{\DUrole{o}{*}\DUrole{n}{args}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
Represents an interaction in which DM scatters and creates two QPs.

This is a container, in the sense that no DM dynamics are actually
contained here. Rather, at initialization, two quasiparticles must be
supplied as arguments.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{qp1}} (\sphinxcode{\sphinxupquote{Quasiparticle}}) \textendash{} final state quasiparticle 1.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{qp2}} (\sphinxcode{\sphinxupquote{Quasiparticle}}) \textendash{} final state quasiparticle 2.

\end{itemize}

\end{description}\end{quote}
\index{allowed() (scdc.interaction.DarkMatterScatter method)@\spxentry{allowed()}\spxextra{scdc.interaction.DarkMatterScatter method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.DarkMatterScatter.allowed}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{allowed}}}{}{}
Determine whether the process is allowed for this initial state.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
\sphinxtitleref{True} if the process can occur. Otherwise \sphinxtitleref{False}.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{Interaction (class in scdc.interaction)@\spxentry{Interaction}\spxextra{class in scdc.interaction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.Interaction}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.interaction.}}\sphinxbfcode{\sphinxupquote{Interaction}}}{\emph{\DUrole{n}{initial\_state}}, \emph{\DUrole{n}{material}}, \emph{\DUrole{o}{*}\DUrole{n}{args}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
Parent class for interactions.

An interaction combines an initial state, a material, and a final state.
Subclasses must provide the means to go from the initial state to the final
state.

Interactions are inherently treelike and can be treated as such. The
complication is that the initial and final states are \sphinxtitleref{Particle} objects,
not \sphinxtitleref{Interaction} objects. This necessitates the introduction of a new
container type, \sphinxtitleref{InteractionNode}, which specifies a particle and
the interaction in which it participates.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{initial\_state}} (\sphinxcode{\sphinxupquote{list}} of \sphinxcode{\sphinxupquote{Particle}}) \textendash{} particles in the
initial state. The initial state is always a list, even if it
contains only one object.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{(}}\sphinxstyleliteralstrong{\sphinxupquote{obj}} (\sphinxstyleliteralemphasis{\sphinxupquote{material}}) \textendash{} \sphinxtitleref{Material}): the material in which this takes place.

\end{itemize}

\end{description}\end{quote}
\index{initial\_state (scdc.interaction.Interaction attribute)@\spxentry{initial\_state}\spxextra{scdc.interaction.Interaction attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.Interaction.initial_state}}\pysigline{\sphinxbfcode{\sphinxupquote{initial\_state}}}
particles in the
initial state. The initial state is always a list, even if it
contains only one object.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{list}} of \sphinxcode{\sphinxupquote{Particle}}

\end{description}\end{quote}

\end{fulllineitems}



\begin{fulllineitems}
\pysigline{\sphinxbfcode{\sphinxupquote{material~(obj}}}
\sphinxtitleref{Material}): the material in which this takes place.

\end{fulllineitems}

\index{n\_initial (scdc.interaction.Interaction attribute)@\spxentry{n\_initial}\spxextra{scdc.interaction.Interaction attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.Interaction.n_initial}}\pysigline{\sphinxbfcode{\sphinxupquote{n\_initial}}}
how many particles should be in the initial state.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{n\_final (scdc.interaction.Interaction attribute)@\spxentry{n\_final}\spxextra{scdc.interaction.Interaction attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.Interaction.n_final}}\pysigline{\sphinxbfcode{\sphinxupquote{n\_final}}}
how many particles should be in the final state.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{initial (scdc.interaction.Interaction attribute)@\spxentry{initial}\spxextra{scdc.interaction.Interaction attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.Interaction.initial}}\pysigline{\sphinxbfcode{\sphinxupquote{initial}}}
types of the initial particles,
listed in order of their appearance.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{tuple}} of \sphinxtitleref{type}

\end{description}\end{quote}

\end{fulllineitems}

\index{final (scdc.interaction.Interaction attribute)@\spxentry{final}\spxextra{scdc.interaction.Interaction attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.Interaction.final}}\pysigline{\sphinxbfcode{\sphinxupquote{final}}}
types of the final particles, listed in
order of their appearance.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{tuple}} of \sphinxtitleref{type}

\end{description}\end{quote}

\end{fulllineitems}

\index{ip (scdc.interaction.Interaction attribute)@\spxentry{ip}\spxextra{scdc.interaction.Interaction attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.Interaction.ip}}\pysigline{\sphinxbfcode{\sphinxupquote{ip}}}
first of the initial particles.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
\sphinxcode{\sphinxupquote{Particle}}

\end{description}\end{quote}

\end{fulllineitems}

\index{allowed() (scdc.interaction.Interaction method)@\spxentry{allowed()}\spxextra{scdc.interaction.Interaction method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.Interaction.allowed}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{allowed}}}{}{}
Determine whether the process is allowed for this initial state.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
\sphinxtitleref{True} if the process can occur. Otherwise \sphinxtitleref{False}.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{interact() (scdc.interaction.Interaction method)@\spxentry{interact()}\spxextra{scdc.interaction.Interaction method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.Interaction.interact}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{interact}}}{}{}
Interact, validate outcome, and set final state.

\end{fulllineitems}

\index{valid\_initial() (scdc.interaction.Interaction class method)@\spxentry{valid\_initial()}\spxextra{scdc.interaction.Interaction class method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.Interaction.valid_initial}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{classmethod }}\sphinxbfcode{\sphinxupquote{valid\_initial}}}{\emph{\DUrole{n}{initial\_state}}}{}
Check that an initial state contains the correct particle types.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{initial\_state}} (\sphinxcode{\sphinxupquote{list}} of \sphinxcode{\sphinxupquote{Particle}}) \textendash{} candidate initial
state to validate.

\item[{Returns}] \leavevmode
\begin{description}
\item[{\sphinxtitleref{True} if the supplied initial state has the right particle}] \leavevmode
types for this interaction. Otherwise \sphinxtitleref{False}.

\end{description}


\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{PhononDecayToQuasiparticles (class in scdc.interaction)@\spxentry{PhononDecayToQuasiparticles}\spxextra{class in scdc.interaction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.PhononDecayToQuasiparticles}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.interaction.}}\sphinxbfcode{\sphinxupquote{PhononDecayToQuasiparticles}}}{\emph{\DUrole{o}{*}\DUrole{n}{args}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
The \sphinxtitleref{Interaction} for a phonon to decay to two quasiparticles.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{tolerance}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} a numerical tolerance for root\sphinxhyphen{}finding.
Defaults to 1e\sphinxhyphen{}3.

\end{description}\end{quote}
\index{tolerance (scdc.interaction.PhononDecayToQuasiparticles attribute)@\spxentry{tolerance}\spxextra{scdc.interaction.PhononDecayToQuasiparticles attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.PhononDecayToQuasiparticles.tolerance}}\pysigline{\sphinxbfcode{\sphinxupquote{tolerance}}}
a numerical tolerance for root\sphinxhyphen{}finding.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{allowed() (scdc.interaction.PhononDecayToQuasiparticles method)@\spxentry{allowed()}\spxextra{scdc.interaction.PhononDecayToQuasiparticles method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.PhononDecayToQuasiparticles.allowed}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{allowed}}}{}{}
Determine whether the process is allowed.

Phonon decay can always take place if the energy of the phonon is at
least 2*Delta.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
\sphinxtitleref{True} if phonon decay can occur. Otherwise \sphinxtitleref{False}.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{decay\_angles() (scdc.interaction.PhononDecayToQuasiparticles method)@\spxentry{decay\_angles()}\spxextra{scdc.interaction.PhononDecayToQuasiparticles method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.PhononDecayToQuasiparticles.decay_angles}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{decay\_angles}}}{\emph{\DUrole{n}{Eqp1}}, \emph{\DUrole{n}{Eqp2}}, \emph{\DUrole{n}{s1}}, \emph{\DUrole{n}{s2}}}{}
Computes the relative angles of two QPs created in phonon decay.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Eqp1}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} energy of quasiparticle 1.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Eqp2}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} energy of quasiparticle 2.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{s1}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} sign appearing in the inverse dispersion relation (QP1).

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{s2}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} sign appearing in the inverse dispersion relation (QP2).

\end{itemize}

\item[{Returns}] \leavevmode
relative cos(theta) of quasiparticle 1.
float: relative cos(theta) of quasiparticle 2.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{qp\_energy\_distribution() (scdc.interaction.PhononDecayToQuasiparticles method)@\spxentry{qp\_energy\_distribution()}\spxextra{scdc.interaction.PhononDecayToQuasiparticles method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.PhononDecayToQuasiparticles.qp_energy_distribution}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{qp\_energy\_distribution}}}{\emph{\DUrole{n}{n\_bins}\DUrole{o}{=}\DUrole{default_value}{1000}}, \emph{\DUrole{n}{eps}\DUrole{o}{=}\DUrole{default_value}{1e\sphinxhyphen{}10}}}{}
Relative probability for a quasiparticle energy in phonon decay.

This is basically the integrand of eq. (27) of Kaplan+ 1976.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{n\_bins}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of (linear) bins to use for QP
energies. Defaults to 1000.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{eps}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} slight offset to prevent divide\sphinxhyphen{}by\sphinxhyphen{}zero
errors. Defaults to 1e\sphinxhyphen{}10.

\end{itemize}

\item[{Returns}] \leavevmode

QP energy bin centers.
\sphinxcode{\sphinxupquote{ndarray}} of \sphinxcode{\sphinxupquote{float}}: relative rate for each bin center,
\begin{quote}

normalized to unity.
\end{quote}


\item[{Return type}] \leavevmode
\sphinxcode{\sphinxupquote{ndarray}} of \sphinxcode{\sphinxupquote{float}}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{QuasiparticlePhononEmission (class in scdc.interaction)@\spxentry{QuasiparticlePhononEmission}\spxextra{class in scdc.interaction}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.QuasiparticlePhononEmission}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.interaction.}}\sphinxbfcode{\sphinxupquote{QuasiparticlePhononEmission}}}{\emph{\DUrole{o}{*}\DUrole{n}{args}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
The \sphinxtitleref{Interaction} for a quasiparticle to emit a phonon.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{tolerance}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} a numerical tolerance for root\sphinxhyphen{}finding.
Defaults to 1e\sphinxhyphen{}3.

\end{description}\end{quote}
\index{tolerance (scdc.interaction.QuasiparticlePhononEmission attribute)@\spxentry{tolerance}\spxextra{scdc.interaction.QuasiparticlePhononEmission attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.QuasiparticlePhononEmission.tolerance}}\pysigline{\sphinxbfcode{\sphinxupquote{tolerance}}}
a numerical tolerance for root\sphinxhyphen{}finding.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{allowed() (scdc.interaction.QuasiparticlePhononEmission method)@\spxentry{allowed()}\spxextra{scdc.interaction.QuasiparticlePhononEmission method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.QuasiparticlePhononEmission.allowed}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{allowed}}}{\emph{\DUrole{n}{exact}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
Determine whether the process is allowed for this initial state.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
\sphinxtitleref{True} if the process can occur. Otherwise \sphinxtitleref{False}.

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{final\_state\_angles() (scdc.interaction.QuasiparticlePhononEmission method)@\spxentry{final\_state\_angles()}\spxextra{scdc.interaction.QuasiparticlePhononEmission method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.QuasiparticlePhononEmission.final_state_angles}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{final\_state\_angles}}}{\emph{\DUrole{n}{phonon\_energy}}, \emph{\DUrole{n}{sp}}}{}
Cosine of angle of final state particles after QP scattering.

Both angles are computed relative to the direction of the proximal
quasiparticle just before scattering, not necessarily the initial
quasiparticle.

DEBUGGING NOTE: this follows section “Better” of \sphinxtitleref{dispersion.nb}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{phonon\_energy}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} phonon energy in units of Delta.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{qp\_energy}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Initial quasiparticle energy in units of Delta.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{sp}} (\sphinxcode{\sphinxupquote{list}} of int) \textendash{} momentum sign for final quasiparticle.

\end{itemize}

\item[{Returns}] \leavevmode
cosine of the angle of the emitted quasiparticle.
float: cosine of the angle of the emitted phonon.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{min\_cos\_deflection() (scdc.interaction.QuasiparticlePhononEmission method)@\spxentry{min\_cos\_deflection()}\spxextra{scdc.interaction.QuasiparticlePhononEmission method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.QuasiparticlePhononEmission.min_cos_deflection}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{min\_cos\_deflection}}}{}{}
Max angular deflection, expressed as minimum of cos(theta).

For a given QP energy, there is a maximum amount of momentum it can
shed via phonon emission. This produces an upper bound on the angular
deflection of the QP. We express this in the form of a lower bound on
the cosine of the deflection angle.
\begin{quote}\begin{description}
\item[{Returns}] \leavevmode
min of cos(theta).

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{phonon\_energy\_distribution() (scdc.interaction.QuasiparticlePhononEmission method)@\spxentry{phonon\_energy\_distribution()}\spxextra{scdc.interaction.QuasiparticlePhononEmission method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.QuasiparticlePhononEmission.phonon_energy_distribution}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{phonon\_energy\_distribution}}}{\emph{\DUrole{n}{n\_bins}\DUrole{o}{=}\DUrole{default_value}{1000}}}{}
Relative phonon emission probability by a quasiparticle.

Computation follows dGamma/dx in eq. (21) of Noah’s note. We normalize
directly. If the distribution cannot be normalized (all values vanish),
both return values are \sphinxtitleref{None}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{n\_bins}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of (linear) bins to use for phonon
energies. Defaults to 1000.

\item[{Returns}] \leavevmode

phonon energy bin centers.
\sphinxcode{\sphinxupquote{ndarray}} of \sphinxcode{\sphinxupquote{float}}: relative rate for each bin center,
\begin{quote}

normalized to unity.
\end{quote}


\item[{Return type}] \leavevmode
\sphinxcode{\sphinxupquote{ndarray}} of \sphinxcode{\sphinxupquote{float}}

\item[{Raises}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{NonPhysicalException}} \textendash{} If the max phonon energy is not positive.

\end{description}\end{quote}

\end{fulllineitems}

\index{phonon\_energy\_region() (scdc.interaction.QuasiparticlePhononEmission method)@\spxentry{phonon\_energy\_region()}\spxextra{scdc.interaction.QuasiparticlePhononEmission method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.interaction.QuasiparticlePhononEmission.phonon_energy_region}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{phonon\_energy\_region}}}{}{}
Min / max allowed phonon energy for emission by a quasiparticle.

The min and max energies are determined by finding the energy range
in which the final\sphinxhyphen{}state angles are physical, i.e. {\color{red}\bfseries{}|cos(theta)|} \textless{} 1.
This needs to be done for both the quasiparticle and phonon angle.
Moreover, since there is a sign ambiguity in the quasiparticle
momentum, this needs to be done for each sign independently to get
self\sphinxhyphen{}consistent regions that work for both the quasiparticle angle and
the phonon angle.

Thus, we take the following approach. For each sign in turn, we find
the physical region for each of the two angles. The intersection of
these two regions is what we want. But then we have to do this for each
sign, and take the union of the resulting intersections.

In principle, this may be disjoint. For the moment, rather than
significantly change the architecture of the code, I will simply throw
an error if the regions are disjoint.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{qp\_energy}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Initial quasiparticle energy in units of Delta.

\item[{Returns}] \leavevmode
minimum emitted phonon energy in units of Delta.
float: maximum emitted phonon energy in units of Delta.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Material objects}
\label{\detokenize{code_structure:module-scdc.material}}\label{\detokenize{code_structure:material-objects}}\index{module@\spxentry{module}!scdc.material@\spxentry{scdc.material}}\index{scdc.material@\spxentry{scdc.material}!module@\spxentry{module}}\index{Material (class in scdc.material)@\spxentry{Material}\spxextra{class in scdc.material}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{scdc.material.}}\sphinxbfcode{\sphinxupquote{Material}}}{\emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
Container class for material properties.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{symbol}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} chemical symbol.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{gamma}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} gamma parameter.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{c\_s}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} speed of sound in m/s.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{T\_c}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} critical temperature in K.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Delta}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} half of the gap in eV.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{E\_F}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Fermi energy in eV.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{m\_star}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} effective mass? in units of m\_e.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{beta}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} beta.

\end{itemize}

\end{description}\end{quote}
\index{symbol (scdc.material.Material attribute)@\spxentry{symbol}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.symbol}}\pysigline{\sphinxbfcode{\sphinxupquote{symbol}}}
chemical symbol.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
str

\end{description}\end{quote}

\end{fulllineitems}

\index{gamma (scdc.material.Material attribute)@\spxentry{gamma}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.gamma}}\pysigline{\sphinxbfcode{\sphinxupquote{gamma}}}
gamma parameter.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{c\_s (scdc.material.Material attribute)@\spxentry{c\_s}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.c_s}}\pysigline{\sphinxbfcode{\sphinxupquote{c\_s}}}
speed of sound in m/s.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{T\_c (scdc.material.Material attribute)@\spxentry{T\_c}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.T_c}}\pysigline{\sphinxbfcode{\sphinxupquote{T\_c}}}
critical temperature in K.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{Delta (scdc.material.Material attribute)@\spxentry{Delta}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.Delta}}\pysigline{\sphinxbfcode{\sphinxupquote{Delta}}}
half of the gap.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{E\_F (scdc.material.Material attribute)@\spxentry{E\_F}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.E_F}}\pysigline{\sphinxbfcode{\sphinxupquote{E\_F}}}
Fermi energy in eV.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{m\_star (scdc.material.Material attribute)@\spxentry{m\_star}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.m_star}}\pysigline{\sphinxbfcode{\sphinxupquote{m\_star}}}
effective mass? in units of m\_e.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{z (scdc.material.Material attribute)@\spxentry{z}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.z}}\pysigline{\sphinxbfcode{\sphinxupquote{z}}}
Fermi energy in units of Delta.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{m\_e (scdc.material.Material attribute)@\spxentry{m\_e}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.m_e}}\pysigline{\sphinxbfcode{\sphinxupquote{m\_e}}}
electron mass in canonical units (v\_l=k\_F=Delta=1).
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{hbar (scdc.material.Material attribute)@\spxentry{hbar}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.hbar}}\pysigline{\sphinxbfcode{\sphinxupquote{hbar}}}
hbar in canonical units (v\_l=k\_F=Delta=1).
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{beta (scdc.material.Material attribute)@\spxentry{beta}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.beta}}\pysigline{\sphinxbfcode{\sphinxupquote{beta}}}
beta.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{mcs2 (scdc.material.Material attribute)@\spxentry{mcs2}\spxextra{scdc.material.Material attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.mcs2}}\pysigline{\sphinxbfcode{\sphinxupquote{mcs2}}}
m*c\_s\textasciicircum{}2 in units of eV.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{qp\_final\_state\_angles\_approx() (scdc.material.Material method)@\spxentry{qp\_final\_state\_angles\_approx()}\spxextra{scdc.material.Material method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{code_structure:scdc.material.Material.qp_final_state_angles_approx}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{qp\_final\_state\_angles\_approx}}}{\emph{\DUrole{n}{phonon\_energy}}}{}
Cosine of angle of final state particles after QP scattering.

This version of the calculation makes the approximation that E\_F is
much, much larger than either the phonon energy or the quasiparticle
energy. In this case, there is actually no dependence on the initial
energy of the quasiparticle. I have checked that this approximation is
very good in the regime we care about.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{phonon\_energy}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} phonon energy in units of Delta.

\item[{Returns}] \leavevmode
cosine of the angle of the emitted quasiparticle.
float: cosine of the angle of the emitted phonon.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Analysis tools}
\label{\detokenize{analysis:analysis-tools}}\label{\detokenize{analysis::doc}}

\subsection{Analysis functions}
\label{\detokenize{analysis:module-scdc.analyze}}\label{\detokenize{analysis:analysis-functions}}\index{module@\spxentry{module}!scdc.analyze@\spxentry{scdc.analyze}}\index{scdc.analyze@\spxentry{scdc.analyze}!module@\spxentry{module}}
This module defines functions for analysis of simulated ensembles.
\index{norm\_asymmetry() (in module scdc.analyze)@\spxentry{norm\_asymmetry()}\spxextra{in module scdc.analyze}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{analysis:scdc.analyze.norm_asymmetry}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{scdc.analyze.}}\sphinxbfcode{\sphinxupquote{norm\_asymmetry}}}{\emph{particles}, \emph{distance\_function=\textless{}function p\_dist.\textless{}locals\textgreater{}.\_dist\textgreater{}}, \emph{n\_bins=50}}{}
Find the asymmetry as the distance from an isotropic distribution.

For any norm, this will give zero for perfectly isotropic scattering. The
maximum depends on the norm. For the default L\textasciicircum{}1 norm, if the scattering is
purely directional, corresponding to a delta function, the difference will
be 0.5 over the whole interval and then the delta function integrates to 1,
so that’ll be a maximum of 2. For the L\textasciicircum{}2 norm, the norm of the delta is
not well defined.

** However, because of the default L\textasciicircum{}1 behavior, the result is divided by
2 regardless of the distance function. **

Because we’re working with a histogram anyway, we don’t want to use any
actual quadrature. Instead, we want to use a p\sphinxhyphen{}norm of some kind. So the
distance function here is not really a norm, but a single\sphinxhyphen{}point integrand
thereof. For example, to use an L\textasciicircum{}2 norm, the distance function should be
\begin{quote}

lambda x: np.abs(x)**2
\end{quote}

and the rest will be taken care of internally.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{particles}} (\sphinxcode{\sphinxupquote{ParticleCollection}}) \textendash{} particles.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{distance\_function}} (\sphinxstyleliteralemphasis{\sphinxupquote{function}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} a function of one variable
giving the integrand of the norm. Defaults to \sphinxtitleref{p\_dist(1)}.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{n\_bins}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of bins to use for the norm. Defaults
to 50.

\end{itemize}

\item[{Returns}] \leavevmode
norm/2 of the distance from an isotropic distribution.

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{p\_dist() (in module scdc.analyze)@\spxentry{p\_dist()}\spxextra{in module scdc.analyze}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{analysis:scdc.analyze.p_dist}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{scdc.analyze.}}\sphinxbfcode{\sphinxupquote{p\_dist}}}{\emph{\DUrole{n}{p}}}{}
Factory for L\textasciicircum{}p\sphinxhyphen{}norm integrands.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{p}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} p for the L\textasciicircum{}p norm.

\item[{Returns}] \leavevmode
L\textasciicircum{}p norm integrand as a function of one argument.

\item[{Return type}] \leavevmode
function

\end{description}\end{quote}

\end{fulllineitems}

\index{plane\_asymmetry() (in module scdc.analyze)@\spxentry{plane\_asymmetry()}\spxextra{in module scdc.analyze}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{analysis:scdc.analyze.plane_asymmetry}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{scdc.analyze.}}\sphinxbfcode{\sphinxupquote{plane\_asymmetry}}}{\emph{\DUrole{n}{particles}}, \emph{\DUrole{n}{n\_bins}\DUrole{o}{=}\DUrole{default_value}{100}}}{}
Find the asymmetry in a sliding bin of width 1 in cos(theta).

For cos(theta) = 1, this corresponds to forward\sphinxhyphen{}backward asymmetry.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{particles}} (\sphinxcode{\sphinxupquote{ParticleCollection}}) \textendash{} particles.

\end{description}\end{quote}

\end{fulllineitems}



\subsection{Plotting functions}
\label{\detokenize{analysis:module-scdc.plot}}\label{\detokenize{analysis:plotting-functions}}\index{module@\spxentry{module}!scdc.plot@\spxentry{scdc.plot}}\index{scdc.plot@\spxentry{scdc.plot}!module@\spxentry{module}}\index{latex\_exp\_format() (in module scdc.plot)@\spxentry{latex\_exp\_format()}\spxextra{in module scdc.plot}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{analysis:scdc.plot.latex_exp_format}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{scdc.plot.}}\sphinxbfcode{\sphinxupquote{latex\_exp\_format}}}{\emph{\DUrole{n}{x}}, \emph{\DUrole{n}{mfmt}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}\%.3f\textquotesingle{}}}}{}
Format a number in scientific notation in LaTeX.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} number to format.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{mfmt}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} format string for mantissa. Defaults to ‘\%.3f’.

\end{itemize}

\item[{Returns}] \leavevmode
LaTeX string (no \$’s).

\item[{Return type}] \leavevmode
str

\end{description}\end{quote}

\end{fulllineitems}

\index{tree\_plot() (in module scdc.plot)@\spxentry{tree\_plot()}\spxextra{in module scdc.plot}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{analysis:scdc.plot.tree_plot}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{scdc.plot.}}\sphinxbfcode{\sphinxupquote{tree\_plot}}}{\emph{\DUrole{n}{particle}}, \emph{\DUrole{n}{origin}\DUrole{o}{=}\DUrole{default_value}{0, 0}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
Plot all child scattering events.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{fig}} (\sphinxcode{\sphinxupquote{Figure}}, optional) \textendash{} matplotlib figure object.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{ax}} (\sphinxcode{\sphinxupquote{AxesSubplot}}, optional) \textendash{} matplotlib axis object.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{origin}} (\sphinxcode{\sphinxupquote{tuple}} of \sphinxcode{\sphinxupquote{float}}, optional) \textendash{} starting
coordinates for the tree.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{dm\_color}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} color for DM lines.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{phonon\_color}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} color for phonon lines.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{qp\_color}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} color for quasiparticle lines.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{min\_linewidth}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} smallest linewidth (E = Delta).

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{max\_linewidth}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} largest linewidth, corresponding
to the energy of the initial excitation.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{max\_linewidth\_energy}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} energy for max linewidth.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{final\_distance}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} if specified, final (ballistic)
state lines will be extended to this distance from (0, 0).

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} opacity.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\section{Using the code}
\label{\detokenize{using:using-the-code}}\label{\detokenize{using::doc}}

\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{q}
\item\relax\sphinxstyleindexentry{scdc.analyze}\sphinxstyleindexpageref{analysis:\detokenize{module-scdc.analyze}}
\item\relax\sphinxstyleindexentry{scdc.event}\sphinxstyleindexpageref{code_structure:\detokenize{module-scdc.event}}
\item\relax\sphinxstyleindexentry{scdc.interaction}\sphinxstyleindexpageref{code_structure:\detokenize{module-scdc.interaction}}
\item\relax\sphinxstyleindexentry{scdc.material}\sphinxstyleindexpageref{code_structure:\detokenize{module-scdc.material}}
\item\relax\sphinxstyleindexentry{scdc.particle}\sphinxstyleindexpageref{code_structure:\detokenize{module-scdc.particle}}
\item\relax\sphinxstyleindexentry{scdc.plot}\sphinxstyleindexpageref{analysis:\detokenize{module-scdc.plot}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}